starter.controller("ResultsCtrl",["$scope","$state","$filter","SettingsFactory","$ionicPopup","$ionicModal","Navigator","NiceFactory",function(t,e,i,n,s,a,o,r){t.niceData=[],t.getData=function(){r.loadNiceData().success(function(e){t.niceData=e})},t.$on("$ionicView.enter",function(){t.showResults(),t.niceGuidelines()}),t.showResults=function(){t.ppvResult=100*parseFloat(window.sessionStorage.PPVglobal),t.ardResult=parseFloat(window.sessionStorage.ard),t.tooYoung=t.checkOldEnough(),t.cumulResult=parseFloat(window.sessionStorage.ardAfter2),t.labels=["PPV RISK",""],t.data=[t.ppvResult,100-t.ppvResult]},t.checkOldEnough=function(){return parseInt(window.sessionStorage.age)<18?!1:!0},t.resetPatient=function(){window.sessionStorage.clear(),o.changeState("app.status")},t.nice="",t.string="",t.niceGuidelines=function(){t.ob_by_id=i("filter")(t.niceData.data,{id:"treatment"}),t.string=JSON.stringify(t.ob_by_id),t.nice+=t.extractText(t.string),parseInt(window.sessionStorage.bcg)>=2&&(t.ob_by_id=i("filter")(t.niceData.data,{id:"bcg vaccinated"}),t.string=JSON.stringify(t.ob_by_id),t.nice+=t.extractText(t.string)),(window.sessionStorage.selectedList.indexOf("AIDS")>=0||window.sessionStorage.selectedList.indexOf("HIV")>=0||window.sessionStorage.selectedList.indexOf("Transplantation")>=0)&&(t.ob_by_id=i("filter")(t.niceData.data,{id:"immunocompromised"}),t.string=JSON.stringify(t.ob_by_id),t.nice+=t.extractText(t.string)),1===parseInt(window.sessionStorage.age)&&(t.ob_by_id=i("filter")(t.niceData.data,{id:"neonates"}),t.string=JSON.stringify(t.ob_by_id),t.nice+=t.extractText(t.string)),parseInt(window.sessionStorage.age)<=2&&1===parseInt(window.sessionStorage.bcg)&&2===parseInt(window.sessionStorage.rc)&&(t.ob_by_id=i("filter")(t.niceData.data,{id:"young-age (without BCG)"}),t.string=JSON.stringify(t.ob_by_id),t.nice+=t.extractText(t.string)),parseInt(window.sessionStorage.age)<=2&&parseInt(window.sessionStorage.bcg)>1&&2===parseInt(window.sessionStorage.rc)&&(t.ob_by_id=i("filter")(t.niceData.data,{id:"young-age (with BCG)"}),t.string=JSON.stringify(t.ob_by_id),t.nice+=t.extractText(t.string))},t.niceList=[],t.extractText=function(){var e=t.string.split('"'),i=e[3],n=e[7],s={};s.name=i,s.text=n,t.niceList.push(s)},t.condTitle="",t.condDetails="",t.sendDataToModal=function(e){t.condTitle=e.name,t.condDetails=e.text},a.fromTemplateUrl("templates/nice-modal.html",{scope:t}).then(function(e){t.modal=e})}]);